<!DOCTYPE html>
<html lang="en" dir="ltr">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>DrinksFinalDraft</title>
    <!--Next two lines are for using the flicketry Plugin for carousel-->
    <link rel="stylesheet" href="https://www.w3schools.com/w3css/4/w3.css">
    <link rel="stylesheet" href="https://unpkg.com/flickity@2/dist/flickity.min.css">
</head>
<style media="screen">

    * {
        box-sizing: border-box;
    }

    .flickity-button {
        background: transparent;
    }

    body {
        font-family: sans-serif;
        overflow: scroll;
    }

        body::-webkit-scrollbar {
            display: none;
        }

    .whole {
        height: auto;
        width: 100%;
        background-color: #f0f0f0;
        padding: 20px;
    }


    .carousel-cell {
        height: 200px;
        width: 300px;
    }

        .carousel-cell img {
            width: 100%; /* Make the image fill the entire width of the cell */
            height: auto; /* Maintain the aspect ratio */
        }

        .carousel-cell h1 {
            position: absolute;
            font-size: 30px;
            top: 5px; /* Adjust this value to control the distance from the top */
            right: 20%; /* Adjust this value to control the distance from the left */
            text-align: center;
            color: #fff; /* Set the text color to white */
            z-index: 1; /* Ensure the text appears above the image */
            font-weight: 500;
            text-shadow: -2px -2px 2px #000, 2px -2px 2px #000, -2px 2px 2px #000, 2px 2px 2px #000; /* Black border */
        }


    .carousel-cell-main {
        width: 100%;
        height: 430px;
        background: #8C8;
        border-radius: 5px;
        /* Add the following styles for horizontal layout */
        display: flex;
        flex-direction: column;
        overflow: hidden; /* Ensures that the image won't exceed the cell boundaries */
        position: relative; /* Position relative for absolute positioning of text */
    }

    .parent-box {
        width: 100%;
        height: 100%;
        display: flex;
        justify-content: space-between;
        align-items: center;
        background: #000;
    }


    /* Style for the left box */
    .left-box {
        width: 30%;
        height: 100%;
        text-align: center;
        background: #ff0000;
    }

        .left-box img {
            max-width: 100%; /* Make sure the image doesn't exceed its container */
            height: 70%;
        }

    /* Style for the middle box */
    .middle-box {
        width: 30%;
        height: 100%;
        text-align: center;
        background: #ffd800;
        overflow: scroll;
    }

        .middle-box::-webkit-scrollbar {
            display: none;
        }

    /* Style for the right box */
    .right-box {
        width: 40%;
        height: 100%;
        text-align: center;
        background: #00ff21;
        overflow: scroll;
    }

        .right-box::-webkit-scrollbar {
            display: none;
        }


        /* Additional styling for h1 and p elements */
        .left-box h1, .middle-box h1, .right-box h1 {
            margin: 10px 0; /* Adjust the margin as needed */
        }

        .left-box p, .middle-box p, .right-box p {
            margin: 10px 0; /* Adjust the margin as needed */
        }
</style>
<body>

    <div class="whole">

        <div class="carousel-nav"
             data-flickity='{ "asNavFor": ".carousel-main",
         "contain": true,
         "autoPlay": true,
         "pageDots": false,
         "wrapAround": true,
         "groupCells":2 }'>
            <div class="carousel-cell"></div>
            <div class="carousel-cell"></div>
            <div class="carousel-cell"></div>
            <div class="carousel-cell"></div>
            <div class="carousel-cell"></div>
            <div class="carousel-cell"></div>
            <div class="carousel-cell"></div>
            <div class="carousel-cell"></div>
            <div class="carousel-cell"></div>
            <div class="carousel-cell"></div>
        </div>


        <!-- Flickity HTML init -->
        <div class="carousel-main" data-flickity='{"wrapAround": true}'>
            <div class="carousel-cell-main"></div>
            <div class="carousel-cell-main"></div>
            <div class="carousel-cell-main"></div>
            <div class="carousel-cell-main"></div>
            <div class="carousel-cell-main"></div>
            <div class="carousel-cell-main"></div>
            <div class="carousel-cell-main"></div>
            <div class="carousel-cell-main"></div>
            <div class="carousel-cell-main"></div>
            <div class="carousel-cell-main"></div>
        </div>
    </div>


    <script>
        let mealIds = [];

        function getRandomMealData() {
            return fetch('https://www.thecocktaildb.com/api/json/v1/1/random.php')
                .then(response => {
                    if (!response.ok) {
                        throw new Error(`HTTP error! Status: ${response.status}`);
                    }
                    return response.json();
                })
                .then(data => data.drinks[0])
                .catch(error => console.error('Error:', error));
        }

        async function updateCarouselCellSnav() {
            const carouselCells = document.querySelectorAll('.carousel-cell');

            const updatePromises = [];

            for (let i = 0; i < carouselCells.length; i++) {
                try {
                    const mealData = await getRandomMealData();
                    mealIds.push(mealData.idDrink);
                    updatePromises.push(updateCarouselCellnav(carouselCells[i], mealData));
                } catch (error) {
                    console.error('Error fetching data:', error);
                }
            }

            return Promise.all(updatePromises);
        }

        function updateCarouselCellnav(carouselCell, mealData) {
            return new Promise(resolve => {
                carouselCell.innerHTML = `
                <h1>${mealData.strDrink}</h1>
                <img src="${mealData.strDrinkThumb}" alt="${mealData.strDrink}">
            `;
                resolve();
            });
        }

        console.log("before");
        console.log(mealIds);

        updateCarouselCellSnav().then(() => {
            console.log("after");
            console.log(mealIds);

            console.log("called the main carousel");
            updateCarouselCellsMain();
        });

        //$$$$$$$$$$$$$$$$$$$$$$
        //FOR CAOURESEL MAIN

        console.log("called the main carousel");

        function getMealDataById(mealid) {

            return fetch(`https://www.thecocktaildb.com/api/json/v1/1/lookup.php?i=${mealid}`)
                .then(response => {
                    if (!response.ok) {
                        throw new Error(`HTTP error! Status: ${response.status}`);
                    }
                    return response.json(); // Parse the response body as JSON
                })
                .then(data => {
                    // Return the data
                    return data.drinks[0];
                })
                .catch(error => {
                    // Handle errors
                    console.error('Error:', error);
                });
        }


        async function updateCarouselCellsMain() {

            const carouselCells = document.querySelectorAll('.carousel-cell-main');


            for (let i = 0; i < carouselCells.length; i++) {
                try {
                    const mealData = await getMealDataById(mealIds[i]);
                    updateCarouselCellMain(carouselCells[i], mealData);
                } catch (error) {
                    console.error('Error fetching data:', error);
                }
            }
        }


        function updateCarouselCellMain(carouselCell, mealData) {
            // Extracting relevant data from mealData
            const name = mealData.strDrink;
            const imageUrl = mealData.strDrinkThumb;
            const category = mealData.strCategory;
            
            const ingredients = getIngredientsList(mealData);
            //const instructions = mealData.strInstructions;
            const instructions = getInstructionsList(mealData);

            // Update HTML content for the given carousel cell
            carouselCell.innerHTML = `
            <div class="parent-box">
                <div class="left-box">
                    <img src="${imageUrl}" alt="${name}">
                    <h1>${name}</h1>
                </div>

                <div class="middle-box">
                    <h1>Category: ${category}</h1>
                    
                    <h1>Ingredients:</h1>
                   <ul>${ingredients}</ul>
                </div>

                <div class="right-box">
                   <h1>Recipe</h1>
                   <ol>${instructions}</ol>
                </div>
            </div>

            `;
        }

        // Helper function to generate the list of ingredients
        function getIngredientsList(mealData) {
            let ingredientsList = '';

            // Iterate through the ingredients and measures
            for (let i = 1; i <= 20; i++) {
                const ingredient = mealData[`strIngredient${i}`];
                const measure = mealData[`strMeasure${i}`];

                // Break the loop if no more ingredients are present
                if (!ingredient) break;

                ingredientsList += `<li>${measure} ${ingredient}</li>`;
            }

            return ingredientsList;
        }
        function getInstructionsList(mealData) {
            let instructionsList = '';

            // Iterate through the ingredients and measures
            const instruction_String = mealData.strInstructions;
            let current_initial_index = 0;
            let current_instruction = '';
            for (let i = 0; i < instruction_String.length; i++) {

                if (instruction_String[i] == '.') {
                    current_instruction = instruction_String.slice(current_initial_index, i);
                    current_initial_index = i;
                    instructionsList += `<li>${current_instruction}</li>`;
                }
                
            }

            return instructionsList;
        }

        updateCarouselCellsMain();

    </script>
    <!--Next two lines are for using the flicketry Plugin for carousel-->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
    <script src="https://unpkg.com/flickity@2/dist/flickity.pkgd.min.js"></script>
</body>
</html>
